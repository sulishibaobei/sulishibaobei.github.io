<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="google-site-verification" content="2mW9mcWKEPuFK_HVf6zCZ8XqtoK5v9WWsSGmauh1WGc" />
<meta name="theme-color" content="#222">
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3e5ef9b9913f4947eb812ab76c9fbf99";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Angular 2+,router,懒加载," />





  <link rel="alternate" href="/atom.xml" title="少女雨的博客" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/a.jpg?v=5.1.2" />






<meta name="description" content="&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;路由的作用就是（导航）：会加载与请求路由相关联的组件，并获取特定路由的相关数据，这允许我们通过控制不同的路由，获取不同的数据，从而渲染不同的页面； 几种常见的路由配置：Angular路由器是一个可选的外部Angular NgModule ，叫RouterModule;路由器里面包含多种服务(RouterModule)，多种指令">
<meta name="keywords" content="Angular 2+,router,懒加载">
<meta property="og:type" content="article">
<meta property="og:title" content="Angular 2+ 路由的那些事">
<meta property="og:url" content="http://www.sulishibaobei.com/angular/route/title20170901/index.html">
<meta property="og:site_name" content="少女雨的博客">
<meta property="og:description" content="&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;路由的作用就是（导航）：会加载与请求路由相关联的组件，并获取特定路由的相关数据，这允许我们通过控制不同的路由，获取不同的数据，从而渲染不同的页面； 几种常见的路由配置：Angular路由器是一个可选的外部Angular NgModule ，叫RouterModule;路由器里面包含多种服务(RouterModule)，多种指令">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-1.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-2.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-3.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-4.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-5.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-6.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-7.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-8.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-9.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-10.png">
<meta property="og:image" content="http://www.sulishibaobei.com/images/router-1.png">
<meta property="og:updated_time" content="2017-09-08T00:56:58.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Angular 2+ 路由的那些事">
<meta name="twitter:description" content="&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;路由的作用就是（导航）：会加载与请求路由相关联的组件，并获取特定路由的相关数据，这允许我们通过控制不同的路由，获取不同的数据，从而渲染不同的页面； 几种常见的路由配置：Angular路由器是一个可选的外部Angular NgModule ，叫RouterModule;路由器里面包含多种服务(RouterModule)，多种指令">
<meta name="twitter:image" content="http://www.sulishibaobei.com/images/router-1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":true,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: 'Sulishibaobei'
    },
    algolia: {
      applicationID: 'MYAWI631K2',
      apiKey: 'b1bd6d9a14214fd15ff7e1cf6128d8e7',
      indexName: 'Content',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.sulishibaobei.com/angular/route/title20170901/"/>







  <title>Angular 2+ 路由的那些事 | 少女雨的博客</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3e5ef9b9913f4947eb812ab76c9fbf99";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">少女雨的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">爱生活爱远方爱自由更爱你</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-主页">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            主页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-关于">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-标签">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-归档">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-展示">
          <a href="/site/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            展示
          </a>
        </li>
      
        
        <li class="menu-item menu-item-日程">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程
          </a>
        </li>
      
        
        <li class="menu-item menu-item-有料">
          <a href="/something" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            有料
          </a>
        </li>
      
        
        <li class="menu-item menu-item-公益404">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.sulishibaobei.com/angular/route/title20170901/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="少女雨">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/a.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="少女雨的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Angular 2+ 路由的那些事</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-01T11:08:53+08:00">
                2017-09-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Angular-2/" itemprop="url" rel="index">
                    <span itemprop="name">Angular 2+</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/angular/route/title20170901/" class="leancloud_visitors" data-flag-title="Angular 2+ 路由的那些事">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> 本文总阅读量
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;路由的作用就是（导航）：会加载与请求路由相关联的组件，并获取特定路由的相关数据，这允许我们通过控制不同的路由，获取不同的数据，从而渲染不同的页面；</p>
<h2 id="几种常见的路由配置："><a href="#几种常见的路由配置：" class="headerlink" title="几种常见的路由配置："></a>几种常见的路由配置：</h2><p>Angular路由器是一个可选的外部Angular NgModule ，叫RouterModule;<br>路由器里面包含多种服务(RouterModule)，多种指令（RouterOutlet，RouterLink,RouterLinkActive），和一套配置（Routes）;</p>
<a id="more"></a>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; RouterModule&#125; from <span class="string">'@angular/router'</span>;</span><br><span class="line"> RouterModule.forRoot([</span><br><span class="line">       &#123;</span><br><span class="line">         path: <span class="string">'test'</span>,</span><br><span class="line">         component: TestComponent</span><br><span class="line">       &#125;</span><br><span class="line"> ]) </span><br><span class="line">&lt;a routerLink=<span class="string">"test"</span>&gt;Test&lt;<span class="regexp">/a&gt; </span></span><br><span class="line"><span class="regexp">&lt;router-outlet&gt;&lt;/</span>router-outlet&gt;</span><br></pre></td></tr></table></figure>
<h3 id="详细解析："><a href="#详细解析：" class="headerlink" title="详细解析："></a>详细解析：</h3><h4 id="路由定义包括下面部分："><a href="#路由定义包括下面部分：" class="headerlink" title="路由定义包括下面部分："></a>路由定义包括下面部分：</h4><ul>
<li>[1]  Path:路由器会用它来匹配浏览器地址栏中的地址，如’test’; </li>
<li>[2]  Component:导航到此路由时，需要加载的组件；<br><strong><font color="#0099ff">注意，path不能以斜杠（/）开头。 路由器会为解析和构建最终的URL，这样当我们在应用的多个视图之间导航时，可以任意使用相对路径和绝对路径。</font></strong></li>
</ul>
<p>另外：</p>
<ol>
<li>这里用到了RouterModule对象为我们提供的两个静态方法：forRoot()和forChild() 来配置路由信息；</li>
<li>forRoot()方法提供了路由需要的路由服务提供商和指令，并基于当前浏览器 URL 初始化导航；用于在模块中定义主要的路由信息，通过调用该方法使得我们的主模块可以访问路由模块中定义的所有指令；</li>
<li>a标签中的routerLink 指令绑定一个字符串，字符串是path路径中配置的字符串，它将告诉路由器，当用户点击这个链接时，应该导航到哪里；</li>
<li>当然routerLink还可以绑定一个数组，就是我们的带参路由,下面会具体介绍的：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">"['/test', id]"</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;还可以在上面这样配置添加一个routerLinkActive指令, 我们需要让用户知道哪个路由处于激活状态，通常情况下我们通过向激活的链接添加一个 class 来实现该功能,然后我们写一个active的类:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"test"</span> <span class="attr">routerLinkActive</span>=<span class="string">"active"</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">   .active&#123;</span><br><span class="line">       color：red</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;当此路由被点击时，字体会变成红色；这也是routerLinkActive的作用，使我们知道哪个路由处于激活状态；当然还可以添加上这个[routerLinkActiveOptions]=”{exact: true}”  只有当路由完全一样时，才会将active类加载上去：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">routerLink</span>=<span class="string">"dashboard"</span> <span class="attr">routerLinkActive</span>=<span class="string">"active"</span>  [<span class="attr">routerLinkActiveOptions</span>]=<span class="string">"&#123;exact: true&#125;"</span>&gt;</span>Dashboard<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;chrome控制台这样显示：<br><img src="/images/router-1.png" alt="cmd-markdown-logo"><br>&nbsp;&nbsp;&nbsp;&nbsp;可见routerLink还是会自动将路由链接到href上的；class=”active“也作用上去啦；当切换路由时：<br><img src="/images/router-2.png" alt="cmd-markdown-logo"><br><code>class=”active”</code> 移到我点击的路由上，只是应该是调用了：ngAfterContentInit(),ngOnChanges(),ngOnDestroy()</p>
<p>注意：第一个路径片段可以以 / ，./ 或 ../ 开头：<br>  如果以 / 开头，路由将从根路由开始查找<br>  如果以 ./ 开头或没有使用 / ，则路由将从当前激活路由的子路由开始查找<br>  如果以 ../ 开头，路由往上一级查找<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> [<span class="attr">routerLink</span>]=<span class="string">"['../test', id]"</span>&gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>当然这里我们也可以通过在component里控制写:</strong><br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Router&#125; from <span class="string">'@angular/router'</span>;</span><br><span class="line">&lt;a (click)=<span class="string">"go()"</span>&gt;Heroes&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">constructor(private router: Router) &#123;&#125;</span></span><br><span class="line"><span class="regexp">go() &#123;</span></span><br><span class="line"><span class="regexp">  this.router.navigate(['heroes']);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>这种效果也是一样的；这里就需要注入router服务：router方法用于切换路由很有用，下面会具体来介绍router服务的；<br>   路由出口:RouterOutlet是由RouterModule提供的指令之一。当我们在应用中导航时，路由器就把激活的组件显示在<code>&lt;/router-outlet&gt;</code> 里面。不写<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>会导致组件内容不加载进来，从而不显示内容；<br>但是一个组件可以共用一个routeroutlet，所以app.component.ts里面配置即可：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-outlet</span>&gt;</span><span class="tag">&lt;/<span class="name">router-outlet</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="第二种写法："><a href="#第二种写法：" class="headerlink" title="第二种写法："></a>第二种写法：</h2><p>请看代码：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">RouterModule.forRoot([...]) 将[] 及中间的内容当成配置文件提取出去；</span><br><span class="line">RouterModule.forRoot(routes),</span><br><span class="line">routes是我们需要导入的配置文件参数名：</span><br><span class="line"><span class="keyword">import</span> &#123; routes&#125; from <span class="string">'./app-routing.module'</span>;</span><br><span class="line">app-routing.module:中我们可以这样写：</span><br><span class="line"><span class="keyword">import</span> &#123; DashboardComponent &#125; from <span class="string">'./dashboard/dashboard.component'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; HeroesComponent &#125; from <span class="string">'./hero/heroes.component'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; HeroDetailComponent &#125; from <span class="string">'./detail/hero-detail.component'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> routes = [</span><br><span class="line">  &#123; path: <span class="string">''</span>, redirectTo: <span class="string">'/dashboard'</span>, pathMatch: <span class="string">'full'</span> &#125;,</span><br><span class="line">  &#123; path: <span class="string">'dashboard'</span>,  component: DashboardComponent &#125;,</span><br><span class="line">  &#123; path: <span class="string">'detail/:id'</span>, component: HeroDetailComponent &#125;,</span><br><span class="line">  &#123; path: <span class="string">'heroes'</span>,     component: HeroesComponent &#125;,  &#123; path: <span class="string">'**'</span>, component:DashboardComponent&#125;];</span><br></pre></td></tr></table></figure></p>
<p><strong>注意：</strong><br> <strong>{ path: ‘’, redirectTo: ‘/dashboard’, pathMatch: ‘full’ }</strong><br>   表示重定向路由：需要一个pathMatch属性，告诉路由器是如何用URL去匹配路由的路径的，没有这个属性就会报错；意思就是当路由URL等于’’时，会去加载DashboardComponent组件；所以你运行你的服务端口号：localhost:4200首先加载的就会是这个组件；<br><em><font color="#000000">{ path: “**”, component:DashboardComponent}</font></em><br>   **路径是一个通配符，表示除了以上几种path,任何的路径都会加载DashboardComponent组件，这个记得写在路由配置最后</p>
<h3 id="当然这种方式我们还能这么写"><a href="#当然这种方式我们还能这么写" class="headerlink" title="当然这种方式我们还能这么写:"></a>当然这种方式我们还能这么写:</h3><ol>
<li><p>无declarations！声明是关联模块的重点。我们将AppRoutingModule抛出去，当做一个路由模块，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Routes,RouterModule&#125; <span class="keyword">from</span> <span class="string">'@angular/router'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; DashboardComponent &#125; <span class="keyword">from</span> <span class="string">'./dashboard/dashboard.component'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; HeroesComponent &#125; <span class="keyword">from</span> <span class="string">'./hero/heroes.component'</span>;</span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">''</span>, <span class="attr">redirectTo</span>: <span class="string">'/dashboard'</span>, <span class="attr">pathMatch</span>: <span class="string">'full'</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">'dashboard'</span>,  <span class="attr">component</span>: DashboardComponent &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">'heroes'</span>,     <span class="attr">component</span>: HeroesComponent &#125;</span><br><span class="line">];</span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [ RouterModule.forChild(routes) ],</span><br><span class="line">  exports: [ RouterModule ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppRoutingModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>app.module.ts中引入：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AppRoutingModule&#125; from <span class="string">'./app-routing.module'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>imports:中导入这个就可以啦<strong>AppRoutingModule</strong><br>这种用法和上面这种用法是一样的还有一点：如何解决第二次刷新出现404问题：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[RouterModule.forRoot(routes,&#123;useHash:<span class="literal">true</span>&#125;)]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>配置后面这一点，通过添加一个#，防止刷新第二次出现404；<em><a href="http://localhost:4201/#" target="_blank" rel="noopener">http://localhost:4201/#</a></em><br>RouterModule.forChild(routes)写在子模块里面，而且这边用的是forChild(),不是forRoot（）,使用forRoot()也是不会错的，但是一般情况下<br><code><font color="red">根模块中使用forRoot()，子模块中使用forChild()</font></code><br>   forChild()只能用在特性模块中，这样的一点好处就是我们不必在主模块就配置好所有的路由信息，在需要的时候将他们导入主模块；</p>
<h3 id="参数化路由"><a href="#参数化路由" class="headerlink" title="参数化路由"></a>参数化路由</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; path: <span class="string">'detail/:id'</span>, component: HeroDetailComponent &#125;,</span><br></pre></td></tr></table></figure>
<p>配置参数化路由格式： :id 是一个占位符，当导航到HeroDetailCompnent组件上时，会被填入一个特定的id；<br><strong>这里我们是这样绑定的：</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> *<span class="attr">ngFor</span>=<span class="string">"let hero of heroes"</span>  [<span class="attr">routerLink</span>]=<span class="string">"['/detail', hero.id]"</span>  <span class="attr">class</span>=<span class="string">"col-1-4"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><font color="red">eg: <a href="http://localhost:4201/detail/11" target="_blank" rel="noopener">http://localhost:4201/detail/11</a> 这时的id等于11；</font></p>
<ul>
<li>[1]传参类型的id作用可以根据传入的id不同让HeroDetailComponent显示不同的内容；</li>
<li>[2]但是怎么能让其显示不同的内容呢？ 也就和我们这个id有关系，如何获取这个id 用在我们的组件里面呢？</li>
<li>[3]通过注入ActivatedRoute服务，一站式获取路由信息；<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ActivatedRoute&#125; from <span class="string">'@angular/router'</span>;</span><br><span class="line"> <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> route: ActivatedRoute,</span></span><br><span class="line"><span class="params">     </span>) &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>接下来我们这样试试：</strong><br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> params;</span><br><span class="line"><span class="keyword">this</span>.route.params.subscribe(</span><br><span class="line">      params =&gt; &#123;</span><br><span class="line">         <span class="keyword">this</span>.params = params;</span><br><span class="line">         <span class="built_in">console</span>.log(<span class="keyword">this</span>.params);</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br></pre></td></tr></table></figure></p>
<p><em>这样获取来的是一个对象：直接取id就能获取到了；既然是一站式获取，肯定不止这几个功能 后面会具体介绍它：</em></p>
<h3 id="路由配置是也可以通过子路由来配置children："><a href="#路由配置是也可以通过子路由来配置children：" class="headerlink" title="路由配置是也可以通过子路由来配置children："></a>路由配置是也可以通过子路由来配置children：</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path: <span class="string">'heroes'</span>,</span><br><span class="line">    component: HeroesComponent,</span><br><span class="line">    children: [</span><br><span class="line">      &#123; path: <span class="string">'heroTest'</span>, component: HeroTestComponent &#125;,</span><br><span class="line">    ]</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>是这样配置的；此时HeroTestComponent组件的路由其实是:’heroes/heroTest’;</p>
<h3 id="懒加载loadChildren"><a href="#懒加载loadChildren" class="headerlink" title="懒加载loadChildren:"></a>懒加载loadChildren:</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     path:<span class="string">'loadtest'</span>,</span><br><span class="line">     loadChildren:<span class="string">'./loadtest/loadtest.module#LoadtestModule'</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p><strong>路由是这样配置的</strong>：</p>
<ul>
<li>[1]这里注意几点：<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; LoadtestComponent &#125; from <span class="string">'./loadtest/loadtest.component'</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>组件不需要在app.module.ts引入</p>
<ul>
<li><p>[2]loadtest.module.ts 也不需要在app.module.ts中引入；而是通过loadchildren属性，在需要的时候告诉Angular路由依据loadchildren<br>属性配置的路径去加载LoadtestModule模块，这就是模块懒加载功能；当用户需要的时候才回去加载，大大减少了应用启动时的资源加载大小；</p>
</li>
<li><p>[3] loadChildren后面的字符串由三部分组成：<br>(3.1) 需要导入模块路劲的相对路径<br>(3.2) #分隔符<br>(3.3) 导出模块类的名称</p>
</li>
<li><p>[4]还有一点也是也是重要的：loadtestModule代码是这样的：里面要引入自己的路由；</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; from <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;CommonModule&#125; from <span class="string">'@angular/common'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; LoadtestComponent &#125; from <span class="string">'./loadtest.component'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;RouterModule&#125; from <span class="string">'@angular/Router'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;route&#125; from <span class="string">'./loadtest-routing.module'</span>;</span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">    imports:[</span><br><span class="line">        CommonModule,</span><br><span class="line">        RouterModule.forChild(route),</span><br><span class="line">    ],</span><br><span class="line">    declarations:[</span><br><span class="line">        LoadtestComponent</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> LoadtestModule&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>在route路由里面记得这样配置这样一句才不会出错：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; LoadtestComponent &#125; from <span class="string">'./loadtest.component'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> route = [</span><br><span class="line">    &#123;</span><br><span class="line">       path:<span class="string">''</span>,</span><br><span class="line">        component: LoadtestComponent</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p><font color="red">path:’’,才能保证代码不出错；</font><br>懒加载的文件要注意：app.module.ts中：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">declarations: [</span><br><span class="line">   AppComponent,</span><br><span class="line">   DashboardComponent,</span><br><span class="line">   HeroDetailComponent,</span><br><span class="line">   HeroesComponent,</span><br><span class="line">   TestComponent,</span><br><span class="line"> ],</span><br></pre></td></tr></table></figure></p>
<p>这里面的文件，采用懒在家的模块是引用不到得，因为lazy加载文件有自己的ngModule ，如果要使用的组件是同一个，最好建立一个shareModule模块；<br>采用commonModule 将共享文件放进去，之后的Module里使用再加载进imports中；</p>
<h2 id="Router服务："><a href="#Router服务：" class="headerlink" title="Router服务："></a>Router服务：</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">class</span> Router&#123;</span><br><span class="line"><span class="number">2.</span>         errorHandler:ErrorHandler</span><br><span class="line"><span class="number">3.</span>         navigated: <span class="built_in">boolean</span></span><br><span class="line"><span class="number">4.</span>         urlHandlingStrategy:UrlHandlingStrategy</span><br><span class="line"><span class="number">5.</span>         routeReuseStrategy:RouteReuseStrategy</span><br><span class="line"><span class="number">6.</span>         config:Routes</span><br><span class="line"><span class="number">7.</span>        initialNavigation():<span class="built_in">void</span></span><br><span class="line"><span class="number">8.</span>        setUpLocationChangeListener():<span class="built_in">void</span></span><br><span class="line"><span class="number">9.</span>        <span class="keyword">get</span> routerState():RouterState</span><br><span class="line"><span class="number">10.</span>       <span class="keyword">get</span> url(): <span class="built_in">string</span></span><br><span class="line"><span class="number">11.</span>       <span class="keyword">get</span> events():Observable&lt;Event&gt;</span><br><span class="line"><span class="number">12.</span>       resetConfig(config:Routes):<span class="built_in">void</span></span><br><span class="line"><span class="number">13.</span>       ngOnDestroy():<span class="built_in">void</span></span><br><span class="line"><span class="number">14.</span>       dispose():<span class="built_in">void</span></span><br><span class="line"><span class="number">15.</span>       createUrlTree(commands: <span class="built_in">any</span>[], navigationExtras:NavigationExtras):UrlTree</span><br><span class="line"><span class="number">16.</span>       navigateByUrl(url: <span class="built_in">string</span>|UrlTree, extras:NavigationExtras):Promise&lt;<span class="built_in">boolean</span>&gt;</span><br><span class="line"><span class="number">17.</span>       navigate(commands: <span class="built_in">any</span>[], extras:NavigationExtras):Promise&lt;<span class="built_in">boolean</span>&gt;</span><br><span class="line"><span class="number">18.</span>       serializeUrl(url:UrlTree): <span class="built_in">string</span></span><br><span class="line"><span class="number">19.</span>       parseUrl(url: <span class="built_in">string</span>):UrlTree</span><br><span class="line"><span class="number">20.</span>       isActive(url: <span class="built_in">string</span>|UrlTree, exact: <span class="built_in">boolean</span>): <span class="built_in">boolean</span></span><br><span class="line"><span class="number">21.</span>       &#125;</span><br></pre></td></tr></table></figure>
<p>这是Router API为我们提供的方法和属性；</p>
<p>看看几个常用的：</p>
<h3 id="navigate"><a href="#navigate" class="headerlink" title="navigate()"></a><code>navigate()</code></h3><p>该方法支持的参数类型和routerLink指令一样，所以他们的作用也是一样的：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.router.navigate([<span class="string">'test'</span>, id]);</span><br></pre></td></tr></table></figure></p>
<p><strong>或者</strong><br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.router.navigate([<span class="string">'test'</span>]);</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>调用该方法后页面会自动跳转到对应的路由地址；<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.router.navigate([<span class="string">'test'</span>], &#123; relativeTo: <span class="keyword">this</span>.route&#125;);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>我们可以设置一个参照路径，参照路径this.route从ActivatedRoute里面取；配置这个可以让自己知道相对于什么位置导航，this.route就是相对于当前的路由进行导航，<br>假如当前url：localhost:4200/hero ,那么导航后的结果就是：localhost:4200/hero/test</p>
<h3 id="navigateByUrl"><a href="#navigateByUrl" class="headerlink" title="navigateByUrl()"></a>navigateByUrl()</h3><p> 这个叫做绝对路由；<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.router.navigateByUrl(<span class="string">'home'</span>);</span><br></pre></td></tr></table></figure></p>
<p>可以帮助你快速的切换到某个路由下面，如果你当时的路由是这样的：<br>localhost:4200/hero/test 点击这个路由后就是：localhost:4200/home 我们一般用这个路由来回到首页；<br>和navigate()的区别还有点是：这个不是根据参数来确定路由地址的</p>
<h3 id="config-会将页面所有的路由配置信息都显示："><a href="#config-会将页面所有的路由配置信息都显示：" class="headerlink" title="config 会将页面所有的路由配置信息都显示："></a>config 会将页面所有的路由配置信息都显示：</h3><p><img src="/images/router-3.png" alt="cmd-markdown-logo"><br>看看路由树：<br><img src="/images/router-4.png" alt="cmd-markdown-logo"></p>
<h3 id="url-输出当前-的路由path"><a href="#url-输出当前-的路由path" class="headerlink" title="url 输出当前 的路由path"></a>url 输出当前 的路由path</h3><p><code><br>eg：<a href="http://localhost:4200/detail/11" target="_blank" rel="noopener">http://localhost:4200/detail/11</a><br>url: /detail/11<br></code></p>
<h3 id="每次导航前都会调用events方法；"><a href="#每次导航前都会调用events方法；" class="headerlink" title="每次导航前都会调用events方法；"></a>每次导航前都会调用events方法；</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RouterModule.forRoot(routes, &#123;enableTracing: <span class="literal">true</span> &#125;)</span><br></pre></td></tr></table></figure>
<p>通过在控制台配置enableTracing: true可以在控制台看到相关改变；<br> <strong>注意：enableTracing: true 只能在forRoot()里面添加</strong><br>具体的事件有：<br><img src="/images/router-5.png" alt="cmd-markdown-logo"><br> chrome控制台:<br><img src="/images/router-6.png" alt="cmd-markdown-logo"><br><strong>注意：这些事件是以Observable的形式提供的</strong></p>
<h2 id="ActivateRoute-API"><a href="#ActivateRoute-API" class="headerlink" title="ActivateRoute API :"></a>ActivateRoute API :</h2><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> ActivatedRoute &#123;</span><br><span class="line">snapshot: ActivatedRouteSnapshot</span><br><span class="line">url: Observable&lt;UrlSegment[]&gt;</span><br><span class="line">params: Observable&lt;Params&gt;</span><br><span class="line">queryParams: Observable&lt;Params&gt;</span><br><span class="line">fragment: Observable&lt;<span class="built_in">string</span>&gt;</span><br><span class="line">data: Observable&lt;Data&gt;</span><br><span class="line">outlet: <span class="built_in">string</span></span><br><span class="line">component: Type&lt;<span class="built_in">any</span>&gt;|<span class="built_in">string</span>|<span class="literal">null</span></span><br><span class="line"><span class="keyword">get</span> routeConfig(): Route|<span class="literal">null</span></span><br><span class="line"><span class="keyword">get</span> root(): ActivatedRoute</span><br><span class="line"><span class="keyword">get</span> parent(): ActivatedRoute|<span class="literal">null</span></span><br><span class="line"><span class="keyword">get</span> firstChild(): ActivatedRoute|<span class="literal">null</span></span><br><span class="line"><span class="keyword">get</span> children(): ActivatedRoute[]</span><br><span class="line"><span class="keyword">get</span> pathFromRoot(): ActivatedRoute[]</span><br><span class="line"><span class="keyword">get</span> paramMap(): Observable&lt;ParamMap&gt;</span><br><span class="line"><span class="keyword">get</span> queryParamMap(): Observable&lt;ParamMap&gt;</span><br><span class="line">toString(): <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="parmaMap"><a href="#parmaMap" class="headerlink" title="parmaMap"></a>parmaMap</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一步：<span class="keyword">import</span> &#123; Router, ActivatedRoute, ParamMap &#125; from <span class="string">'@angular/router'</span>;</span><br><span class="line">第二步：<span class="keyword">import</span> <span class="string">'rxjs/add/operator/switchMap'</span>;导入switchMap操作符是因为我们稍后将会处理路由参数的可观察对象Observable ;会在以后的章节中介绍操作符的；</span><br><span class="line">第三步：</span><br><span class="line">constructor(</span><br><span class="line"> <span class="keyword">private</span> heroService: HeroService,</span><br><span class="line"> <span class="keyword">private</span> route: ActivatedRoute,</span><br><span class="line"> <span class="keyword">private</span> router: Router,</span><br><span class="line">  ) &#123;&#125;</span><br><span class="line">&lt;code&gt; &lt;br&gt;&lt;/code&gt;</span><br></pre></td></tr></table></figure>
<p>假定事先写好了HeroService：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.route.paramMap</span><br><span class="line">   .switchMap((params: ParamMap) =&gt; <span class="keyword">this</span>.heroService.getHero(+params.get(<span class="string">'id'</span>)))</span><br><span class="line">    .subscribe(hero =&gt; <span class="keyword">this</span>.hero = hero );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>我们这样操作，前面已经介绍过用parmas获取参数；所以这样写也可以，用的是paramMap就引入paramMap，params就引入Params</p>
 <figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.route.params</span><br><span class="line">     .switchMap((params: Params) =&gt; <span class="keyword">this</span>.heroService.getHero(+params[<span class="string">'id'</span>]))</span><br><span class="line">     .subscribe(hero =&gt;</span><br><span class="line">       <span class="keyword">this</span>.hero = hero;</span><br><span class="line">     &#125;</span><br><span class="line">     );</span><br></pre></td></tr></table></figure>
<p>由于参数是作为Observable提供的，所以我们得用switchMap操作符来根据名字取得id参数，并告诉HeroService来获取带有那个id的英雄。</p>
<h3 id="snapshot-快照"><a href="#snapshot-快照" class="headerlink" title="snapshot(快照)"></a>snapshot(快照)</h3><p>route.snapshot提供了路由参数的初始值。 我们可以通过它来直接访问参数，而不用订阅或者添加Observable的操作符<br>所以获取参数的id还可以这样：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> *<span class="attr">ngFor</span>=<span class="string">"let hero of heroes"</span>  [<span class="attr">routerLink</span>]=<span class="string">"['/detail', hero.id]"</span>  <span class="attr">class</span>=<span class="string">"col-1-4"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">br</span>&gt;</span>this.params = this.route.snapshot.paramMap.get('id');<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>console.log(this.params);</span><br></pre></td></tr></table></figure></p>
<p> 所以上面的代码改成这样更好：</p>
 <figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.params = <span class="keyword">this</span>.route.snapshot.paramMap.get(<span class="string">'id'</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.params);</span><br><span class="line"><span class="keyword">this</span>.heroService.getHero(<span class="keyword">this</span>.params)</span><br><span class="line">  .then(hero =&gt; <span class="keyword">this</span>.hero = hero);</span><br></pre></td></tr></table></figure>
<p>两种方法：params 和snapshot到底什么时候该用哪种呢？</p>
<ol>
<li>需要直接访问参数，主要获取初始值，不用订阅的情况下用snapshot；</li>
<li>需要连续导航多次的用params;</li>
</ol>
<h2 id="总结-路由主要是用到了这些方面啦："><a href="#总结-路由主要是用到了这些方面啦：" class="headerlink" title="总结 ,路由主要是用到了这些方面啦："></a>总结 ,路由主要是用到了这些方面啦：</h2><p> <img src="/images/router-7.png" alt="cmd-markdown-logo"></p>
<h2 id="给路由添加一些新特性："><a href="#给路由添加一些新特性：" class="headerlink" title="给路由添加一些新特性："></a>给路由添加一些新特性：</h2><h3 id="添加动画"><a href="#添加动画" class="headerlink" title="添加动画"></a>添加动画</h3><p>[1] 在app.module.ts中引入启用Angular动画必备的, 记得在imports中导入：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserAnimationsModule &#125; from <span class="string">'@angular/platform-browser/animations'</span>;</span><br></pre></td></tr></table></figure></p>
<p>[2] 在app.component.ts同级下创建一个animation.ts文件，用来存放我们的动画效果；<br> <figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> &#123; animate, AnimationEntryMetadata, state, style, transition, trigger &#125; from <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> slideInDownAnimation: AnimationEntryMetadata =</span><br><span class="line">  trigger(<span class="string">'routeAnimation'</span>, [</span><br><span class="line">    state(<span class="string">'*'</span>,</span><br><span class="line">      style(&#123;</span><br><span class="line">        opacity: <span class="number">1</span>,</span><br><span class="line">        transform: <span class="string">'translateX(0)'</span></span><br><span class="line">      &#125;)</span><br><span class="line">    ),</span><br><span class="line">    transition(<span class="string">':enter'</span>, [</span><br><span class="line">      style(&#123;</span><br><span class="line">        opacity: <span class="number">0</span>,</span><br><span class="line">        transform: <span class="string">'translateX(-100%)'</span></span><br><span class="line">      &#125;),</span><br><span class="line">      animate(<span class="string">'0.2s ease-in'</span>)</span><br><span class="line">    ]),</span><br><span class="line">    transition(<span class="string">':leave'</span>, [</span><br><span class="line">      animate(<span class="string">'0.5s ease-out'</span>, style(&#123;</span><br><span class="line">        opacity: <span class="number">0</span>,</span><br><span class="line">        transform: <span class="string">'translateY(100%)'</span></span><br><span class="line">      &#125;))</span><br><span class="line">    ])</span><br><span class="line">  ]);</span><br></pre></td></tr></table></figure></p>
<p> 假定我有以上代码，视图进场和出场；</p>
<ol>
<li>构建动画需要的库；</li>
<li>导出了一个名叫slideInDownAnimation的常量，并把它设置为一个名，用于外部引入此ts文件；</li>
<li>叫routeAnimation的动画触发器。带动画的组件将会引用这个名字。用在外部html页面引用</li>
<li>指定了一个通配符状态 —— *，它匹配该路由组件存在时的任何动画状态。</li>
<li>定义两个过渡效果，其中一个（:enter）在组件进入应用视图时让它从屏幕左侧缓动进入（ease-in），另一个（:leave）在组件离开应用视图时让它向下飞出。</li>
</ol>
<p>[3] 如何使用动画；</p>
<ol>
<li>在需要的组件中引入变量名为：slideInDownAnimation的文件animation.ts；</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;slideInDownAnimation&#125; from <span class="string">'../animation'</span>;</span><br></pre></td></tr></table></figure>
<p>[4]组件中配置<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">templateUrl: <span class="string">'hero-detail.component.html'</span>,</span><br><span class="line">animations: [slideInDownAnimation]</span><br></pre></td></tr></table></figure></p>
<p>[5]html模板中这样引入：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div *ngIf=<span class="string">"hero"</span> [<span class="meta">@routeAnimation</span>]=<span class="string">"'active'"</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p> @routeAnimation 动画触发器名<br><img src="/images/router-8.png" alt="cmd-markdown-logo"><br> 点击之后会自动加载动画的；</p>
<h3 id="多重路由出口"><a href="#多重路由出口" class="headerlink" title="多重路由出口"></a>多重路由出口</h3><p><strong>一般情况下：我们使用一个路由出口就行啦，什么情况下会使用第二路由呢？</strong></p>
<p>1.创建一个新组件ComposemessageComponent<br>2.路由配置：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    path:<span class="string">'compose'</span>,</span><br><span class="line">    component:ComposemessageComponent,</span><br><span class="line">    outlet:<span class="string">'popup'</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>3.html页面这样配置：<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;nav&gt;</span><br><span class="line">   &lt;a routerLink=<span class="string">"dashboard"</span> routerLinkActive=<span class="string">"active"</span>  [routerLinkActiveOptions]=<span class="string">"&#123;exact: true&#125;"</span>&gt;Dashboard&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">   &lt;a (click)="go()" &gt;Heroes&lt;/</span>a&gt;</span><br><span class="line">   &lt;a routerLink=<span class="string">"test"</span>  routerLinkActive=<span class="string">"active"</span>  [routerLinkActiveOptions]=<span class="string">"&#123;exact: true&#125;"</span>&gt;Test&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">    &lt;a routerLink="loadtest"  routerLinkActive="active"&gt;loadTest&lt;/</span>a&gt; </span><br><span class="line">    &lt;a [routerLink]=<span class="string">"[&#123; outlets: &#123; popup: ['compose'] &#125; &#125;]"</span>&gt;Contact&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp"> &lt;/</span>nav&gt;</span><br><span class="line">&lt;router-outlet&gt;&lt;<span class="regexp">/router-outlet&gt;</span></span><br><span class="line"><span class="regexp">&lt;router-outlet name="popup"&gt;&lt;/</span>router-outlet&gt;</span><br></pre></td></tr></table></figure></p>
<p>这是我的页面所有的路由配置；<br><img src="/images/router-9.png" alt="cmd-markdown-logo"><br>点击Contact 不会替换其他的组件信息，注意看<code>Url:<a href="http://localhost:4200/dashboard(popup:compose" target="_blank" rel="noopener">http://localhost:4200/dashboard(popup:compose</a>)</code><br>点击Contact url地址没有变成<code><a href="http://localhost:4200/contact" target="_blank" rel="noopener">http://localhost:4200/contact</a></code>而是采用圆括号加载</p>
<ul>
<li>圆括号包裹的部分是第二路由。</li>
<li>第二路由包括一个出口名称（popup）、一个冒号分隔符和第二路由的路径（compose）<br>而是显示在下面，点击test也是一样：<br><img src="/images/router-10.png" alt="cmd-markdown-logo"></li>
</ul>
<p>Contact路由加载的组件不会被清除，一直显示在下面，状态一直被激活；<br>这里我们就能知道第二路由的用处：即使在应用中的不同页面之间切换，这个组件也应该始终保持打开状态，多重出口可以在同一时间根据不同的路由来显示不同的内容；<br>但是什么时候清除我们的第二路由呢？如果我页面不需要呢？<br>注意：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> (<span class="attr">click</span>)=<span class="string">"go()"</span> &gt;</span>Heroes<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">go() &#123;</span><br><span class="line">   this.router.navigateByUrl('heroes');</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>当点击Heroes时，Contact路由加载的内容就不会被显示：<br><img src="/images/router-1.png" alt="cmd-markdown-logo"><br>原因是这样的：<br>它使用Router.navigateNyUrl()方法进行强制导航,所以路由清除啦；<br>还可以这样清除：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.router.navigate([&#123; outlets: &#123; popup: <span class="literal">null</span> &#125;&#125;]);</span><br><span class="line">outlets属性的值是另一个对象，该对象用一些出口名称作为属性名。 唯一的命名出口是<span class="string">'popup'</span>。但这里，<span class="string">'popup'</span>的值是<span class="literal">null</span>。<span class="literal">null</span>不是一个路由，</span><br><span class="line">但却是一个合法的值。 把popup这个RouterOutlet设置为<span class="literal">null</span>会清除该出口，并且从当前URL中移除第二路由popup</span><br></pre></td></tr></table></figure>
<h3 id="路由守卫"><a href="#路由守卫" class="headerlink" title="路由守卫"></a>路由守卫</h3><p>按照上面所说：任何用户都能在任何时候导航到任何地方，这样就有问题，可能此用户并没有权限切换到此路由，<br>可能用户未登陆不能切换，或者做一些友好提示之后再切换；<br>所以路由守卫就来了：<br>守卫返回一个值，以控制路由器的行为：</p>
<ol>
<li>如果它返回true，导航过程会继续</li>
<li>如果它返回false，导航过程会终止，且用户会留在原地。<br>也就是你导航的路由是可以取消的，路由守卫还有一个好处就是回退功能时，可以防止用户无限回退，走出app；<br>路由守卫怎么做：<br>用CanActivate来处理导航到某路由的情况。<br>用CanActivateChild来处理导航到某子路由的情况。<br>用CanDeactivate来处理从当前路由离开的情况.<br>用Resolve在路由激活之前获取路由数据。<br>用CanLoad来处理异步导航到某特性模块的情况。</li>
</ol>
<hr>
<p>返回的值是一个Observable<boolean>或Promise<boolean>，路由器会等待这个可观察对象被解析为true或false。<br>在分层路由的每个级别上，我们都可以设置多个守卫。 路由器会先按照从最深的子路由由下往上检查的顺序来检查CanDeactivate()和CanActivateChild()守卫。 然后它会按照从上到下的顺序检查CanActivate()守卫。 如果特性模块是异步加载的，在加载它之前还会检查CanLoad()守卫。 如果任何一个守卫返回false，其它尚未完成的守卫会被取消，这样整个导航就被取消了。<br>看看路由守卫怎么实现：<br>1.new 一个新项目activeComponent;<br>2.编写守卫服务：</boolean></boolean></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; from <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CanActivate &#125; from <span class="string">'@angular/router'</span>;</span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> LoadTestService <span class="keyword">implements</span> CanActivate&#123;</span><br><span class="line">   canActivate() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'AuthGuard#canActivate called'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 3.路由中这样导入我们的守卫：</p>
 <figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ActiveComponent &#125; from <span class="string">'./active/active.component'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;LoadTestService&#125; from <span class="string">'./loadtest.service'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> route = [</span><br><span class="line">    &#123;</span><br><span class="line">        path:<span class="string">''</span>,</span><br><span class="line">        component: LoadtestComponent,</span><br><span class="line">        canActivate:[LoadTestService],</span><br><span class="line">        children:[</span><br><span class="line">            &#123;</span><br><span class="line">                path:<span class="string">'a'</span>,</span><br><span class="line">                component: ActiveComponent</span><br><span class="line">            &#125;   </span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>这样我们的ActiveComponent就是受保护的； 当然这只是模拟；还有更多用法，以后来列举；</p>

      
    </div>
    
    
    
   
     
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>谢谢你给我的支持，坚持原创技术分享，共同成长</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/zhifubao.jpg" alt="少女雨 WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/weixin.jpg" alt="少女雨 Alipay"/>
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Angular-2/" rel="tag"><i class="fa fa-tag"></i> Angular 2+</a>
          
            <a href="/tags/router/" rel="tag"><i class="fa fa-tag"></i> router</a>
          
            <a href="/tags/懒加载/" rel="tag"><i class="fa fa-tag"></i> 懒加载</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/angular/style/component-style20170902/" rel="prev" title="Angular 2+ 设置组件样式的那些事">
                Angular 2+ 设置组件样式的那些事 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="uyan_frame"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <img class="site-author-image" itemprop="image"
              src="/images/a.jpg"
              alt="少女雨" />
          
            <p class="site-author-name" itemprop="name">少女雨</p>
            <p class="site-description motion-element" itemprop="description">12级毕业生，南方姑娘，前端程序媛，前途堪忧的代码洁癖者;</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives">
            
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">51</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/sulishibaobei/" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="380571249@qq.com" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                    
                      E-Mail
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/xiaoyu051027/profile?rightmod=1&wvr=6&mod=personinfo/" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                    
                      weibo
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/sulishibaobei/" target="_blank" title="CSDN">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                    
                      CSDN
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/sulishibaobei/" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                    
                      博客园
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/u/e6c53e37e95b/" target="_blank" title="简书">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                    
                      简书
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              友情链接
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://segmentfault.com/blog/angular4" title="Angular 4.x 修仙之路" target="_blank">Angular 4.x 修仙之路</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#几种常见的路由配置："><span class="nav-number">1.</span> <span class="nav-text">几种常见的路由配置：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#详细解析："><span class="nav-number">1.1.</span> <span class="nav-text">详细解析：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#路由定义包括下面部分："><span class="nav-number">1.1.1.</span> <span class="nav-text">路由定义包括下面部分：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二种写法："><span class="nav-number">2.</span> <span class="nav-text">第二种写法：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#当然这种方式我们还能这么写"><span class="nav-number">2.1.</span> <span class="nav-text">当然这种方式我们还能这么写:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参数化路由"><span class="nav-number">2.2.</span> <span class="nav-text">参数化路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路由配置是也可以通过子路由来配置children："><span class="nav-number">2.3.</span> <span class="nav-text">路由配置是也可以通过子路由来配置children：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#懒加载loadChildren"><span class="nav-number">2.4.</span> <span class="nav-text">懒加载loadChildren:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Router服务："><span class="nav-number">3.</span> <span class="nav-text">Router服务：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#navigate"><span class="nav-number">3.1.</span> <span class="nav-text">navigate()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#navigateByUrl"><span class="nav-number">3.2.</span> <span class="nav-text">navigateByUrl()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#config-会将页面所有的路由配置信息都显示："><span class="nav-number">3.3.</span> <span class="nav-text">config 会将页面所有的路由配置信息都显示：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#url-输出当前-的路由path"><span class="nav-number">3.4.</span> <span class="nav-text">url 输出当前 的路由path</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#每次导航前都会调用events方法；"><span class="nav-number">3.5.</span> <span class="nav-text">每次导航前都会调用events方法；</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ActivateRoute-API"><span class="nav-number">4.</span> <span class="nav-text">ActivateRoute API :</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#parmaMap"><span class="nav-number">4.1.</span> <span class="nav-text">parmaMap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#snapshot-快照"><span class="nav-number">4.2.</span> <span class="nav-text">snapshot(快照)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结-路由主要是用到了这些方面啦："><span class="nav-number">5.</span> <span class="nav-text">总结 ,路由主要是用到了这些方面啦：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#给路由添加一些新特性："><span class="nav-number">6.</span> <span class="nav-text">给路由添加一些新特性：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#添加动画"><span class="nav-number">6.1.</span> <span class="nav-text">添加动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多重路由出口"><span class="nav-number">6.2.</span> <span class="nav-text">多重路由出口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#路由守卫"><span class="nav-number">6.3.</span> <span class="nav-text">路由守卫</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">少女雨</span>

  
</div>
 

 

        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>本站访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人次
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 本站总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  



  
  









  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/three.min.js"></script>

  
  <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  
    

    
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2142986"></script>
      <!-- UY END -->
    
  










  






  
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine@1.1.4/dist/Valine.min.js"></script>
  <script type="text/javascript">
    new Valine({
        av: AV,
        el: '#vcomments' ,
        verify: true,
        notify: true,
        app_id: 'oYvo5UGPyqh0hJS4PjPlUEUi-gzGzoHsz',
        app_key: 'pvthlFHzxUG7QED17mtXdnYo',
        placeholder: 'Comment input placeholder'
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === '') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("oYvo5UGPyqh0hJS4PjPlUEUi-gzGzoHsz", "pvthlFHzxUG7QED17mtXdnYo");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  

  <script type="text/javascript" src="/js/src/love.js"></script>
</body>
</html>
